(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["login"],{"0ccc":function(e,t,n){"use strict";n.d(t,"a",function(){return s}),n.d(t,"b",function(){return d});n("28a5"),n("96cf");var o,c,i=n("1da1"),r=n("cab5");window.location.href;function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"app",i="";return"app"===n?i="".concat(o).concat(e):"wx"===n?i="".concat(c).concat(e):"custom"===n&&(i="".concat(t.rootUrl).concat(e)),i.indexOf("mock")>-1&&(i="https://www.fastmock.site/mock/3ea6a0d021ca4e477f697983f54a9c58/native/".concat(e.substring(0,e.length-5))),i}function s(e,t,n,o){var c=a(e,t,n);return Object(r["callPostSign"])(c,t,o)}function u(e,t,n,o){var c=a(e,t,n);return Object(r["callApi"])(c,t,"post",o)}function d(){return l.apply(this,arguments)}function l(){return l=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!=r["isWechat"]&&-1!=window.location.href.indexOf("cyh369.com")){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise(function(e,t){var n=Object(r["getStorage"])("openId");if("string"!=typeof n&&(Object(r["removeStorage"])("openId"),n=""),n)return e(n);if(-1!==window.location.href.indexOf("code")){var o=Object(r["getNowUrlParams"])().code;u("LoginController/getWeiXinUserInfo",{code:o},"wx").then(function(t){if(t&&t.openId)return Object(r["setStorage"])("openId",t.openId),e(t.openId)})}else{var c="www.cyh369.com";-1!==c.indexOf("?#")?c=encodeURIComponent(c):-1!==c.indexOf("#")&&(c=encodeURIComponent(c.split("#").join("?#"))),window.location.href="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxd6004bf616254aad&redirect_uri=".concat(c,"&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect")}}));case 3:case"end":return e.stop()}},e)})),l.apply(this,arguments)}o="http://www.cyh369.com/"},3052:function(e,t,n){"use strict";var o=n("f3e2"),c=n.n(o);c.a},e3ac:function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"yjk-login"},[n("div",{staticClass:"padding"}),n("div",{staticClass:"yjk-login-other"},[n("div",{staticClass:"yjk-login-btn",class:e.isAllowLogin?"yjk-login-btn-blue":"yjk-login-btn-gray",on:{click:e.login}},[e._v("一键登录")])])])},c=[],i=(n("a481"),n("28a5"),n("4917"),n("96cf"),n("1da1")),r=n("8b55"),a=n("0ccc"),s={data:function(){return{mutualAidStatus:"PROCESSING",account:"",password:"",errorMsg:"",isGetCode:!1,downCode:60,codeTxt:"发送验证码",isAllowLogin:!1,userImg:!0,regPhoneNum:/^0?(1[3456789])[0-9]{9}$/}},mounted:function(){var e=this.$route.query;e.mutualAidStatus&&(this.mutualAidStatus=e.mutualAidStatus),r["d"]&&this.getOpenId()},methods:{getOpenId:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,o;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(console.log("getOpenId",localStorage.getItem("openId")),localStorage.getItem("openId")){e.next=17;break}if(-1===window.location.href.indexOf("code")){e.next=13;break}return t=window.location.href.match(/code=(.+)&/)[1],e.next=6,Object(r["b"])("getUserInfoByCode",{code:t},"wx");case 6:if(n=e.sent,console.log("getUserInfoByCode-res",n),n){e.next=10;break}return e.abrupt("return");case 10:localStorage.setItem("openId",n.openId),e.next=17;break;case 13:o="www.cyh369.com",console.log("url",o),-1!==o.indexOf("?#")?o=encodeURIComponent(o):-1!==o.indexOf("#")&&(o=encodeURIComponent(o.split("#").join("?#"))),window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxd6b3142e82014a77&redirect_uri=".concat(o,"&response_type=code&scope=snsapi_base&state=STATE#wechat_redirect"));case 17:case"end":return e.stop()}},e)}));function t(){return e.apply(this,arguments)}return t}(),getCode:function(){var e=this;if(!this.isGetCode){this.isGetCode=!0,this.timer=setInterval(function(){e.downCode-=1,0==e.downCode&&e.resetCode()},1e3);var t={phoneNumber:this.account};Object(r["b"])("account/getIdentifyingCode",t,"app",!0).then(function(t){t&&200==t.code||(e.resetCode(),Object(r["e"])(t.msg))})}},resetCode:function(){this.downCode=60,this.isGetCode=!1,this.codeTxt="重新发送",clearInterval(this.timer)},handleUserAgreement:function(){this.userImg=!this.userImg,this.checkBtnBlue()},handleInput:function(){this.checkBtnBlue()},checkBtnBlue:function(){this.account&&this.password&&this.userImg?this.isAllowLogin=!0:this.isAllowLogin=!1},jumpText:function(e){"user"==e?location.href="https://app.h5.ihaozhuo.com/native/useragreement/index.html":"privacy"==e&&(location.href="https://app.h5.ihaozhuo.com/native/privacypolicy/index.html")},login:function(){var e=this;Object(a["b"])(function(t){console.log("getAndSaveOpenId",t),t&&(e.openId=t,addBIMaiDian("H5活动","口罩分享助力页",e.openId),e.requestDetail(t))}),console.log(123),localStorage.setItem("userInfo",JSON.stringify());var t=localStorage.getItem("userInfo");Object(r["b"])("login",JSON.parse(t),"app",!0).then(function(t){t&&0==t.status?(e.saveUserInfo(t.data),e.$router.replace({path:"home"})):Object(r["e"])(t.message)})},saveUserInfo:function(e){e&&(localStorage.setItem("token",e.token),localStorage.setItem("userInfo",JSON.stringify(e)))}}},u=s,d=(n("3052"),n("2877")),l=Object(d["a"])(u,o,c,!1,null,"6ce7974a",null);t["default"]=l.exports},f3e2:function(e,t,n){}}]);